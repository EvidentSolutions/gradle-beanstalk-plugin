plugins {
    id "com.gradle.plugin-publish" version "0.9.1"
}

apply plugin: 'maven'
apply plugin: 'java-gradle-plugin'
apply plugin: 'eclipse'
   
def env = System.getenv()
def nexusUser = env['nexusUser']
def nexusPassword = env['nexusPassword']
repositories {
    jcenter()
    mavenLocal()
    mavenCentral()
    maven { url "https://repo.spring.io/libs-release" }
    maven { url =  "http://nexus.ebgroup.elektrobit.com:8080/nexus/content/groups/public/" }
    maven {
        url = "http://nexus.ebgroup.elektrobit.com:8080/nexus/content/repositories/accelera.snapshots/"
        credentials {
            username nexusUser
            password nexusPassword
        }
    }
    maven {
        url = "http://nexus.ebgroup.elektrobit.com:8080/nexus/content/repositories/accelera.releases/"
        credentials {
            username nexusUser
            password nexusPassword
        }
    }
}

ext {
    awsApiVersion = '1.10.13'
}

dependencies {
    compile "com.amazonaws:aws-java-sdk-elasticbeanstalk:$awsApiVersion"
    compile "com.amazonaws:aws-java-sdk-s3:$awsApiVersion"
    compile "com.amazonaws:aws-java-sdk-core:$awsApiVersion"
    compile "com.amazonaws:aws-java-sdk-sts:$awsApiVersion"
}

group = 'com.elektrobit.odin'
version '0.0.65'

pluginBundle {
    website = 'https://github.com/EvidentSolutions/gradle-beanstalk-plugin'
    vcsUrl = 'https://github.com/EvidentSolutions/gradle-beanstalk-plugin'
    description = 'Gradle plugin for AWS Elastic Beanstalk'
    tags = ['aws', 'beanstalk']

    plugins {
        beanstalkPlugin {
            id = 'fi.evident.beanstalk'
            displayName = 'Gradle Beanstalk plugin'
        }
    }
}

uploadArchives {
	repositories.mavenDeployer {
		repository(url :  "http://nexus.ebgroup.elektrobit.com:8080/nexus/content/repositories/con.releases/"){
			authentication(userName: nexusUser, password: nexusPassword)
		}
		snapshotRepository(url :  "http://nexus.ebgroup.elektrobit.com:8080/nexus/content/repositories/con.snapshots/"){
			authentication(userName: nexusUser, password: nexusPassword)
		}
	}
}